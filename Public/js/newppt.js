/*! author:Mr Qiu , date:2018-03-28 */

var LogDevelopment={error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,e)},info:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.info.apply(console,e)},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,e)},log:function(){if(window.dynamicPptDebug){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)}},trace:function(){if(window.dynamicPptDebug){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.trace.apply(console,e)}},debug:function(){if(window.dynamicPptDebug){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.debug.apply(console,e)}}};window.dynamicPptLog=LogDevelopment,window.onload=function(){var e=document.createElement("div");e.className="ppt-supernatant",e.id="ppt_supernatant",document.body.appendChild(e);var t,n,L=document.getElementById("ppt_supernatant");window.GLOBAL=window.GLOBAL||{},t="../../Public/css/newppt.css?ts=2018032210",(n=document.createElement("link")).type="text/css",n.rel="stylesheet",n.href=t,document.getElementsByTagName("head")[0].appendChild(n),window.GLOBAL.onPlayerInit=function(e){function w(){var e=document.querySelectorAll("audio"),t=document.querySelectorAll("video");if(0<e.length)for(var n=0;n<e.length;n++){var i=e[n];i.volume=parseFloat(window.GLOBAL.PptVolumeValue),window.GLOBAL.PptVolumeMute?i.mute=!0:i.mute=!1}if(0<t.length)for(n=0;n<t.length;n++){var a=t[n];a.volume=parseFloat(window.GLOBAL.PptVolumeValue),window.GLOBAL.PptVolumeMute?a.mute=!0:a.mute=!1}var o=e.length+t.length;if(o!==window.GLOBAL.totalAudioAndVideoNumber){var r={action:"allVideoAndAudio",allVideoAndAudioLength:window.GLOBAL.totalAudioAndVideoNumber=o};window.GLOBAL.ServiceNewPptAynamicPPT.postMessageToParent(r)}}function m(e){for(var t=document.getElementsByTagName("audio"),n=t.length-1;0<=n;n--)e&&t[n].pause(),t[n].play=a;var i=document.getElementsByTagName("video");for(n=i.length-1;0<=n;n--)e&&i[n].pause(),i[n].play=o}function a(e,t){window.GLOBAL.notPlayAV||window.GLOBAL.isNotPlayAudio||e||this&&this.__proto__&&this.__proto__.play&&"function"==typeof this.__proto__.play&&this.__proto__.play.apply(this,arguments)}function o(e,t){if(window.GLOBAL.notPlayAV||window.GLOBAL.isNotPlayVideo||window.GLOBAL.playback);else if(e){var n=window.GLOBAL.newPptAynamicThat.that;if(t=t||{},this){var i="new_ppt_video_"+(new Date).getTime();this.setAttribute("id",i);var a=this.querySelectorAll("source"),o=void 0;if(a&&0<a.length){for(var r=0;r<a.length;r++){var l=a[r];if(l&&-1!==l.getAttribute("type").indexOf("webm")){o=l.getAttribute("src");break}}if(!o)return void dynamicPptLog.error("video resouce webm url is not exist!",a);var d={action:"autoPlayVideoInNewPpt",videoElementId:i,isvideo:!0,fileid:window.GLOBAL.fileid,url:o,pptslide:t.pptslide,externalData:t.externalData};n.postMessageToParent(d)}}}else this&&this.__proto__&&this.__proto__.play&&"function"==typeof this.__proto__.play&&this.__proto__.play.apply(this,arguments)}window.GLOBAL.newpptPresentationConnector={},window.GLOBAL.NewPptAynamicPPT=function(e){var t=this;this.options=e||{},this.isResized=!1,this.isOpenPptFile=!1,t.sendMessagePermission=!1,window.GLOBAL.newPptAynamicThat={that:t},this.aynamicPptData={old:{slide:null,step:null,fileid:null},now:{slide:null,step:null,fileid:null}},this.recvAynamicPptData={slide:null,step:null,fileid:null},this.recvCount=0,t.newDopPresentation(e)},window.GLOBAL.NewPptAynamicPPT.prototype={constructor:window.GLOBAL.NewPptAynamicPPT,newDopPresentation:function(e,t){var c=window.GLOBAL.newPptAynamicThat.that;function s(e,t){if(e)for(var n=e.parentNode,i=0;i<200;i++){if(!n||!/(poster|video_player|video_player poster_frame)/g.test(n.className))break;n.style.display=t?"":"none",n=n.parentNode}}function a(e,t){var n=window.GLOBAL.browser;if(n.versions.mobile||n.versions.ios||n.versions.android||n.versions.iPhone||n.versions.iPad)if(n.versions.ios&&null!=window.GLOBAL.deviceType&&0==parseInt(window.GLOBAL.deviceType)){var i={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),null!=t?t<=e?window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextSlide(!0,i):e<t&&window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousSlide(!0,i):window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextSlide(!0,i)}else{if((l=c.view.displayObject().querySelectorAll("video"))&&0<l.length)for(var a=0;a<l.length;a++){(d=l[a])&&(d.style.display="",d.volume=parseFloat(window.GLOBAL.PptVolumeValue),d.load(),d.play(),s(d,!0))}}else{var o=c.view.displayObject().querySelectorAll(".controls .component_container.play .component_base.play");if(o&&0<o.length){if((l=c.view.displayObject().querySelectorAll("video"))&&0<l.length)for(a=0;a<l.length;a++){(d=l[a])&&(d.style.display="",d.volume=parseFloat(window.GLOBAL.PptVolumeValue),d.load(),s(d,!0))}for(a=0;a<o.length;a++){var r=o[a];r&&"false"==r.getAttribute("aria-pressed")&&window.GLOBAL.fireEvent(r,"click")}}else{var l;if((l=c.view.displayObject().querySelectorAll("video"))&&0<l.length)for(a=0;a<l.length;a++){var d;(d=l[a])&&(d.style.display="",d.volume=parseFloat(window.GLOBAL.PptVolumeValue),d.load(),d.play(),s(d,!0))}}}}function o(){var e=c.view.displayObject().querySelectorAll("video");if(e&&0<e.length)for(var t=0;t<e.length;t++){var n=e[t];n&&(n.style.display="none",n.removeAttribute("autoplay"),n.removeAttribute("preload"),n.load(),n.pause(),n.volume=0,s(n))}}function r(e,t){var n=c.view.displayObject().querySelectorAll("video");if(0<n.length){var i=n[n.length-1];if(i){i.style.display="none",i.removeAttribute("autoplay"),i.removeAttribute("preload"),i.load(),i.pause();i.volume=0;var a={pptslide:e,externalData:t};i.play(!0,a),s(i)}}}function p(e,t,n){if(!window.GLOBAL.notPlayAV)if(window.GLOBAL.versions&&2017082901<=window.GLOBAL.versions)if(window.GLOBAL.playback)o();else try{var i=c.view.displayObject().querySelectorAll("video");i&&0<i.length&&(window.GLOBAL.classbegin?2017091401<=window.GLOBAL.versions&&t&&t.initiative&&window.GLOBAL.publishDynamicPptMediaPermission_video||2017082901<=window.GLOBAL.versions&&window.GLOBAL.versions<2017091401&&0==window.GLOBAL.role?r(e,t):t&&t.initiative?a(e,n):o():a(e,n))}catch(e){return void dynamicPptLog.error("视频播放错误:",e)}else window.GLOBAL.isLoadPageController&&a(e,n)}return c.options=e||c.options,c.playbackController=null,c.slidesCount=null,c.isPlayedPresentation=null,c.view=null,c.presentation=null,c.needUpdateSlideAndStep=!1,c.isOpenPptFile=!0,window.GLOBAL.newpptPresentationConnector.register=function(e,t){try{dynamicPptLog.log("receive player and newppt:",e,t),c.presentation=e.presentation(),c.slidesCount=c.presentation.slides().count(),c.view=e.view(),c.viewData={width:c.view.width(),height:c.view.height()},c.playbackController=c.view.restrictedPlaybackController(),c.slideTransitionController=c.playbackController.slideTransitionController(),function(){try{c.playbackController&&c.playbackController.slideChangeEvent&&(c.playbackController.slideChangeEvent().removeHandler(function(e){}),c.playbackController.slideChangeEvent().addHandler(function(t,n){if(window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray=[],window.dynamicPptLog.log("ChangeEvent slideChangeEvent slideIndex and externalData:",t,n),c.isOpenPptFile){var e=c.playbackController.clock().timestamp(),i=e.stepIndex(),a=c.nowSlideIndex;c.nowSlideIndex=t,i=0<=i?i:0;var o=null;if(c.playbackController&&c.playbackController.currentSlide)try{var r=c.playbackController.currentSlide();if(r&&r.animationSteps){var l=r.animationSteps();r&&r.animationSteps&&(o=l.count())}}catch(e){dynamicPptLog.error("that.playbackController.currentSlide error:",e)}if(c.isLoadFinshed){if(c.isLoadFinshed)try{var d={action:"slideChangeEvent",slide:t,step:i,stepTotal:o,externalData:n};c.aynamicPptData.now.slide==t&&c.aynamicPptData.now.step==i||c.postMessageToParent(d),c.videoPlayPPTTimerNum=0,clearInterval(c.videoPlayPPTTimer),m(),c.videoPlayPPTTimer=setInterval(function(){c.videoPlayPPTTimerNum++;var e=c.playbackController.playbackState();dynamicPptLog.log("slide setInterval  videoPlayPPTTimerNum 、 playbackState、slideTransitionControllerState:",c.videoPlayPPTTimerNum,e,c.slideTransitionController.state()),/(playingSlide|pausedSlide|suspended)/g.test(e)&&"playing"!==c.slideTransitionController.state()?(m(),p(t,n,a),w(),clearInterval(c.videoPlayPPTTimer),c.videoPlayPPTTimerNum=0):30<c.videoPlayPPTTimerNum&&(clearInterval(c.videoPlayPPTTimer),c.videoPlayPPTTimerNum=0)},300)}catch(e){dynamicPptLog.error("OnSlideChange",e)}}else{c.isLoadFinshed=!0;var d={action:"initEvent",view:c.viewData,slidesCount:c.slidesCount,slide:t,step:i,stepTotal:o,externalData:n};c.postMessageToParent(d),c.videoPlayPPTTimerNum=0,clearInterval(c.videoPlayPPTTimer),m(),c.videoPlayPPTTimer=setInterval(function(){c.videoPlayPPTTimerNum++;var e=c.playbackController.playbackState();dynamicPptLog.log("slide setInterval  videoPlayPPTTimerNum 、 playbackState、slideTransitionControllerState:",c.videoPlayPPTTimerNum,e,c.slideTransitionController.state()),/(playingSlide|pausedSlide|suspended)/g.test(e)&&"playing"!==c.slideTransitionController.state()?(m(),p(t,n,a),w(),clearInterval(c.videoPlayPPTTimer),c.videoPlayPPTTimerNum=0):30<c.videoPlayPPTTimerNum&&(clearInterval(c.videoPlayPPTTimer),c.videoPlayPPTTimerNum=0)},300),setTimeout(function(){window.GLOBAL.fireEvent(window,"resize")},100)}c.aynamicPptData.now.slide=t,c.aynamicPptData.now.step=0<=i?i:0}c.canJumpToAnim(),window.GLOBAL.checkCustomControllerButtonState&&window.GLOBAL.checkCustomControllerButtonState()})),c.playbackController&&c.playbackController.stepChangeEvent&&(c.playbackController.stepChangeEvent().removeHandler(function(e){}),c.playbackController.stepChangeEvent().addHandler(function(e,t){if(window.dynamicPptLog.log("ChangeEvent stepChangeEvent stepIndex and externalData:",e,t),c.isOpenPptFile){var n=c.playbackController.clock().timestamp(),i=n.slideIndex(),a=null;if(c.playbackController&&c.playbackController.currentSlide)try{var o=c.playbackController.currentSlide();if(o&&o.animationSteps){var r=o.animationSteps();o&&o.animationSteps&&(a=r.count())}}catch(e){dynamicPptLog.error("that.playbackController.currentSlide error:",e)}if(e=0<=e?e:0,c.OnMovToPrvAnimTimer=c.OnMovToPrvAnimTimer||null,c.isLoadFinshed){try{var l={action:"stepChangeEvent",slide:i,step:e,stepTotal:a,externalData:t};c.aynamicPptData.now.slide==i&&c.aynamicPptData.now.step==e||c.postMessageToParent(l)}catch(e){dynamicPptLog.error("OnMovToPrvAnim",e)}var d=i;c.remoteActionDataJson&&c.remoteActionDataJson["remoteActionData_"+d]&&0<c.remoteActionDataJson["remoteActionData_"+d].length&&c.remoteActionDataArrHandler(c.remoteActionDataJson["remoteActionData_"+d])}c.aynamicPptData.now.slide=i,c.aynamicPptData.now.step=0<=e?e:0}c.canJumpToAnim(),window.GLOBAL.checkCustomControllerButtonState&&window.GLOBAL.checkCustomControllerButtonState()})),c.playbackController&&c.playbackController.navigationRestrictedEvent&&c.playbackController.navigationRestrictedEvent().addHandler(function(e){window.dynamicPptLog.log("Navigation action",e.navigationAction(),"is restricted by",e.restrictionSource(),"for the following reason:",e.restrictionReason().type())}),c.playbackController&&c.playbackController.playbackCompleteEvent&&c.playbackController.playbackCompleteEvent().addHandler(function(e){window.dynamicPptLog.log("Presentation playback has been completed."),c.canJumpToAnim()});var e=c.playbackController.clock();e.stateChangeEvent().addHandler(function(e){window.dynamicPptLog.log("Clock state has been changed to",e.state()),c.canJumpToAnim()}),e.stopEvent().addHandler(function(e){var t=e.timestamp();window.dynamicPptLog.log("Clock has been stopped at slide:",t.slideIndex(),"step:",t.stepIndex(),"time offset:",t.timeOffset()),c.canJumpToAnim()}),e.bufferStateChangeEvent().addHandler(function(e){window.dynamicPptLog.log("Clock buffering state has been changed to",e.buffering()),c.canJumpToAnim()}),e.startEvent().addHandler(function(e){var t=e.timestamp();window.dynamicPptLog.log("Clock has been started at slide:",t.slideIndex(),"step:",t.stepIndex(),"time offset:",t.timeOffset()),c.canJumpToAnim()}),c.playbackController.navigationRestrictedEvent().addHandler(function(e){window.dynamicPptLog.log("Navigation action",e.navigationAction(),"is restricted by",e.restrictionSource(),"for the following reason:",e.restrictionReason().type())}),c.slideTransitionController.transitionEffectCompleteEvent().addHandler(function(e){window.dynamicPptLog.log("Transition to slide #"+e+" has been completed."),c.canJumpToAnim()}),c.slideTransitionController.transitionEffectStartEvent().addHandler(function(e){window.dynamicPptLog.log("Transition to slide #"+e+" has been started.")})}catch(e){dynamicPptLog.error("initPlaybackControllerEventsHandlers error:",e)}}(),m(!0)}catch(e){dynamicPptLog.error("register error:",e)}},c.clearOldSlideInfo=function(){o()},c.closeDynamicPptAutoVideo=function(){o()},c.classBeginCheckAutoPlay=function(e,t){if(0==window.GLOBAL.role&&window.GLOBAL.classbegin){if(void 0===e)e=c.playbackController.clock().timestamp().slideIndex();t=t||{initiative:!0},o(),r(e,t)}},c},jumpToAnim:function(e,t,n,i,a){try{var o,r,l=window.GLOBAL.newPptAynamicThat.that;l.jumpToAnimData=null,o=0<=(o=e-1)?o:0,r=0<=(r=t)?r:0,n=null!=n?n:0,i=null==i||i;var d=l.playbackController.clock().timestamp(),c=d.slideIndex(),s=0<=d.stepIndex()?d.stepIndex():0;if(dynamicPptLog.log("nowSlideIndex and nowStepIndex:",c,s,"\n slideIndex and stepIndex:",o,r),o===c&&r===s){try{var p=null;if(l.playbackController&&l.playbackController.currentSlide)try{var w=l.playbackController.currentSlide();if(w&&w.animationSteps){var m=w.animationSteps();w&&w.animationSteps&&(p=m.count())}}catch(e){dynamicPptLog.error("that.playbackController.currentSlide error:",e)}var P={action:"slideChangeEvent",slide:o,step:r,stepTotal:p,externalData:a};l.postMessageToParent(P),l.aynamicPptData.now.slide=o,l.aynamicPptData.now.step=0<=r?r:0}catch(e){dynamicPptLog.error("notJumpToAnim error:",e)}return}null!=e&&null!=t?c===o?0<=r&&0<=s?r-s==1?(dynamicPptLog.log("执行jumpToAnim--\x3egotoNextStep"),l.playbackController.gotoNextStep(a)):s-r==1?(dynamicPptLog.log("执行jumpToAnim--\x3egotoPreviousStep"),l.playbackController.gotoPreviousStep(a)):(window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),l.playbackController.gotoTimestamp(o,r,n,i,a)):(window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),l.playbackController.gotoTimestamp(o,r,n,i,a)):(l.remoteActionDataJson&&l.remoteActionDataJson["remoteActionData_"+o]&&0<l.remoteActionDataJson["remoteActionData_"+o].length&&(l.remoteActionDataJson["remoteActionData_"+o].length=0),o-c==1&&0===r?(dynamicPptLog.log("执行jumpToAnim--\x3egotoNextSlide"),window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),l.playbackController.gotoNextSlide(i,a)):c-o==1&&0===r?(dynamicPptLog.log("执行jumpToAnim--\x3egotoPreviousSlide"),window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),l.playbackController.gotoPreviousSlide(i,a)):(window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),l.playbackController.gotoTimestamp(o,r,n,i,a))):null!=e?(window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),l.playbackController.gotoSlide(o,i,a)):dynamicPptLog.error("slide 和 step必须有值")}catch(e){dynamicPptLog.error("jumpToAnim error:",e)}},canJumpToAnim:function(){var e=this,t=e.playbackController.playbackState();dynamicPptLog.log("canJumpToAnim 当前状态(playbackState and slideTransitionControllerState )：",t,e.slideTransitionController.state(),e.jumpToAnimData?JSON.stringify(e.jumpToAnimData):e.jumpToAnimData),e.jumpToAnimData&&/(playingSlide|pausedSlide|suspended)/g.test(t)&&"playing"!==e.slideTransitionController.state()&&e.jumpToAnim(e.jumpToAnimData.slide,e.jumpToAnimData.step,e.jumpToAnimData.timeOffset,e.jumpToAnimData.autoStart,e.jumpToAnimData.externalData)},postMessageToParent:function(e){if(window.parent&&window.parent!==window)try{var t={source:"tk_dynamicPPT",data:e};t=JSON.stringify(t),window.parent.postMessage(t,"*")}catch(e){dynamicPptLog.error("that.postMessageToParent error:",e)}},clickNewpptTriggerEventHandler:function(e){var t=this,n=t.playbackController.clock().timestamp().slideIndex();if(t.remoteActionDataJson=t.remoteActionDataJson||{},t.remoteActionDataJson["remoteActionData_"+e.slide]=t.remoteActionDataJson["remoteActionData_"+e.slide]||[],t.remoteActionDataJson["remoteActionData_"+e.slide].push(e),e.slide===n){var i=t.remoteActionDataJson["remoteActionData_"+e.slide];t.remoteActionDataArrHandler(i)}},remoteActionDataArrHandler:function(e){for(var t=0;t<e.length;t++){var n,i=e[t];if(n=this.view.displayObject().querySelectorAll("#"+i.triggerElementId),dynamicPptLog.log("clickNewpptTriggerEvent handler element:",i.triggerElementId,n),n&&0<n.length)for(t=0;t<n.length;t++){var a=n[t];if(i.childElementTagName&&(a=a.getElementsByTagName(i.childElementTagName)[0]),"video"===a.nodeName.toLowerCase())return;if(a.getElementsByTagName("video")&&0<a.getElementsByTagName("video").length)return;var o="click";window.GLOBAL.fireEvent(a,o);o="touchstart";window.GLOBAL.fireEvent(a,o);o="touchend";window.GLOBAL.fireEvent(a,o)}}e.length=0}},window.GLOBAL.addEvents=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},window.GLOBAL.removeEvents=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},window.GLOBAL.fireEvent=window.GLOBAL.fireEvent||function(e,t){if(document.createEventObject){var n={initiative:!1};return(i=document.createEventObject()).externalData=n,e.fireEvent("on"+t,i)}var i;(i=document.createEvent("HTMLEvents")).initEvent(t,!0,!0);n={initiative:!1};return i.externalData=n,!e.dispatchEvent(i)},window.GLOBAL.initiativeDataDefault=!0,window.GLOBAL.externalData={initiative:window.GLOBAL.initiativeDataDefault},window.GLOBAL.getUrlParams=window.GLOBAL.getUrlParams||function(e){var t=decodeURIComponent(window.location.href),n=t.indexOf("?"),i=t.substring(n+1),a=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),o=i.match(a);return null!=o?o[2]:""},window.GLOBAL.mClientType=window.GLOBAL.getUrlParams("mClientType"),window.GLOBAL.deviceType=window.GLOBAL.getUrlParams("deviceType"),window.GLOBAL.fileid=window.GLOBAL.getUrlParams("fileid"),window.GLOBAL.fileid=window.GLOBAL.fileid?Number(window.GLOBAL.fileid):window.GLOBAL.fileid,window.GLOBAL.playback="true"==window.GLOBAL.getUrlParams("playback")||1==window.GLOBAL.getUrlParams("playback"),window.GLOBAL.classbegin="true"==window.GLOBAL.getUrlParams("classbegin")||1==window.GLOBAL.getUrlParams("classbegin"),window.dynamicPptDebug=!!window.GLOBAL.getUrlParams("dynamicPptDebug")&&"true"==window.GLOBAL.getUrlParams("dynamicPptDebug"),window.GLOBAL.role=window.GLOBAL.getUrlParams("role"),window.GLOBAL.dynamicPptActionClick=!window.GLOBAL.getUrlParams("dynamicPptActionClick")||"true"==window.GLOBAL.getUrlParams("dynamicPptActionClick"),window.GLOBAL.newpptPagingPage=!!window.GLOBAL.getUrlParams("newpptPagingPage")&&"true"==window.GLOBAL.getUrlParams("newpptPagingPage"),window.GLOBAL.publishDynamicPptMediaPermission_video="true"==window.GLOBAL.getUrlParams("publishDynamicPptMediaPermission_video")||1==window.GLOBAL.getUrlParams("publishDynamicPptMediaPermission_video"),window.GLOBAL.PptVolumeValue=window.GLOBAL.getUrlParams("PptVolumeValue")?parseFloat(window.GLOBAL.getUrlParams("PptVolumeValue")):1,window.GLOBAL.notPlayAV=!!window.GLOBAL.getUrlParams("notPlayAV")&&"true"==window.GLOBAL.getUrlParams("notPlayAV"),window.GLOBAL.PptVolumeMute=!!window.GLOBAL.getUrlParams("PptVolumeMute")&&"true"==window.GLOBAL.getUrlParams("PptVolumeMute"),window.GLOBAL.isNotPlayAudio=!!window.GLOBAL.getUrlParams("isNotPlayAudio")&&"true"==window.GLOBAL.getUrlParams("isNotPlayAudio"),window.GLOBAL.isNotPlayVideo=!!window.GLOBAL.getUrlParams("isNotPlayVideo")&&"true"==window.GLOBAL.getUrlParams("isNotPlayVideo"),window.GLOBAL.isLoadPageController=window.GLOBAL.getUrlParams("isLoadPageController"),window.GLOBAL.browser={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:-1<e.indexOf("Trident"),presto:-1<e.indexOf("Presto"),webKit:-1<e.indexOf("AppleWebKit"),gecko:-1<e.indexOf("Gecko")&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<e.indexOf("Android")||-1<e.indexOf("Linux"),iPhone:-1<e.indexOf("iPhone"),iPad:-1<e.indexOf("iPad"),webApp:-1==e.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||navigator.language).toLowerCase()},window.GLOBAL.languageName=window.GLOBAL.browser.language&&window.GLOBAL.browser.language.toLowerCase().match(/zh/g)?"chinese":"english",window.GLOBAL.versions=window.GLOBAL.getUrlParams("versions"),window.GLOBAL.versions=window.GLOBAL.versions?Number(window.GLOBAL.versions):window.GLOBAL.versions,window.GLOBAL.ServiceNewPptAynamicPPT=new window.GLOBAL.NewPptAynamicPPT,window.GLOBAL.actionHandlerFunction=function(e){try{switch(e.action){case"jumpToAnim":window.GLOBAL.ServiceNewPptAynamicPPT.jumpToAnimData=e.data||{};var t={initiative:window.GLOBAL.ServiceNewPptAynamicPPT.jumpToAnimData.initiative};window.GLOBAL.ServiceNewPptAynamicPPT.jumpToAnimData.externalData=t,window.GLOBAL.ServiceNewPptAynamicPPT.canJumpToAnim();break;case"gotoPreviousStep":if(window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.clock().timestamp().stepIndex()<=0){t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousSlide(!0,t)}else{t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousStep(t)}break;case"gotoNextStep":t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextStep(t);break;case"gotoPreviousSlide":t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousSlide(e.autoStart,t);break;case"gotoNextSlide":t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextSlide(e.autoStart,t);break;case"resizeHandler":dynamicPptLog.log("resizeHandler width and height:",e.width,e.height),window.GLOBAL.ServiceNewPptAynamicPPT.view.resize(e.width,e.height),setTimeout(function(){window.GLOBAL.fireEvent(window,"resize")},250);break;case"clickNewpptTriggerEvent":window.GLOBAL.ServiceNewPptAynamicPPT.clickNewpptTriggerEventHandler(e);break;case"changeClassBegin":window.GLOBAL.classbegin=e.classbegin;break;case"changePublishDynamicPptMediaPermission_video":window.GLOBAL.publishDynamicPptMediaPermission_video=e.publishDynamicPptMediaPermission_video;break;case"closeDynamicPptAutoVideo":window.GLOBAL.ServiceNewPptAynamicPPT.closeDynamicPptAutoVideo();break;case"classBeginCheckAutoPlay":window.GLOBAL.ServiceNewPptAynamicPPT.classBeginCheckAutoPlay();break;case"changeDynamicPptActionClick":window.GLOBAL.dynamicPptActionClick=e.dynamicPptActionClick,window.GLOBAL.dynamicPptActionClick?L.style.display="none":L.style.display="block";break;case"changeNewpptPagingPage":window.GLOBAL.newpptPagingPage=e.newpptPagingPage;break;case"stopDynamicPpt":window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.pause(),window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray=[];for(var n=document.querySelectorAll("audio"),i=0;i<n.length;i++){(a=n[i])&&!a.paused&&(window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray.push(a),a.pause())}break;case"playDynamicPpt":if(window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.play(!1),window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray&&0<window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray.length)for(i=0;i<window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray.length;i++){var a;(a=window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray[i])&&a.paused&&a.play()}window.GLOBAL.ServiceNewPptAynamicPPT.pauseAudioArray=[];break;case"PptVolumeControl":window.GLOBAL.PptVolumeValue=parseFloat(e.volumeValue),w();break;case"ExtendedNotice":e.extendedData&&"updateMute"===e.extendedData.type&&e.extendedData.data&&(window.GLOBAL.PptVolumeMute=e.extendedData.data.mute,w())}}catch(e){dynamicPptLog.error("actionHandlerFunction error:",e)}},window.GLOBAL.getParents=function(e,t){try{void 0===t&&(t="document");for(var n=[],i=e,a=0;;){var o=i;if(!o)break;if(o&&o.getAttribute("id")){n.push(o);break}if(i=o.parentNode,150<++a)break}return n}catch(e){dynamicPptLog.error("getParents error:",e)}},window.GLOBAL.clickTriggerElementToNewPpt=function(e,t){var n=e.target,i=e.currentTarget;window.dynamicPptLog.log("点击触发器，节点数据[target , currentTarget , externalData]:",n,i,t);var a=window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.clock().timestamp(),o=a.slideIndex(),r=0<=a.stepIndex()?a.stepIndex():0,l=null;if(!n.getAttribute("id")&&!i.getAttribute("id")){var d=window.GLOBAL.getParents(i);d&&0<d.length&&(l=d[0].getAttribute("id"))}var c={action:"clickNewpptTriggerEvent",slide:o,step:r,triggerElementId:n.getAttribute("id")||i.getAttribute("id")||l,externalData:t};l&&(c.childElementTagName=i.nodeName),window.GLOBAL.ServiceNewPptAynamicPPT.postMessageToParent(c)};var t=function(n){clearTimeout(window.GLOBAL.documentTimer),window.GLOBAL.documentTimer=setTimeout(function(){if(window.GLOBAL.newpptPagingPage)switch(n.keyCode){case 39:var e=!0,t={initiative:!0};return window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextSlide(e,t),n.preventDefault(),n.stopPropagation(),!1;case 37:e=!0,t={initiative:!0};return window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousSlide(e,t),n.preventDefault(),n.stopPropagation(),!1;case 38:if(window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.clock().timestamp().stepIndex()<=0){e=!0,t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousSlide(e,t)}else{t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousStep(t)}return n.preventDefault(),n.stopPropagation(),!1;case 40:t={initiative:!0};return window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextStep(t),n.preventDefault(),n.stopPropagation(),!1}},400)};window.GLOBAL.removeEvents(document,"keydown",t),window.GLOBAL.addEvents(document,"keydown",t),document.oncontextmenu=null,document.oncontextmenu=function(){return!1};var n=function(e){try{if(dynamicPptLog.log("receive remote iframe's parent  data form "+e.origin+":",e),e.data){var t=JSON.parse(e.data);"tk_dynamicPPT"===t.source&&window.GLOBAL.actionHandlerFunction(t.data)}}catch(e){dynamicPptLog.error("message Event form iframe :",e)}};window.GLOBAL.removeEvents(window,"message",n),window.GLOBAL.addEvents(window,"message",n),window.GLOBAL.dynamicPptActionClick?L.style.display="none":L.style.display="block",window.GLOBAL.newpptPresentationConnector.register(e);var i=document.getElementById("preloader");if(i.parentNode.removeChild(i),window.GLOBAL.isLoadPageController){var r=document.createElement("div");r.id="customPageController",r.style.display="none",r.className="custom-page-controller";var l=document.createElement("button");l.id="customController_prevSlide",l.className="prev-slide",l.innerHTML="chinese"===window.GLOBAL.languageName?"上一页":"Previous Page",l.onclick=function(e){window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousSlide(!0,{initiative:!0})},r.appendChild(l);var d=document.createElement("button");d.id="customController_prevStep",d.className="prev-step",d.innerHTML="chinese"===window.GLOBAL.languageName?"上一帧":"Previous Step",d.onclick=function(e){if(window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.clock().timestamp().stepIndex()<=0){var t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousSlide(!0,t)}else{t={initiative:!0};window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoPreviousStep(t)}},r.appendChild(d);var c=document.createElement("input");c.id="customController_skipSlide",c.className="skip-slide",c.type="number",c.setAttribute("placeholder","chinese"===window.GLOBAL.languageName?"请输入需要跳转的页数":"Please enter the number of pages to jump"),c.onchange=function(e){var t=Number(this.value);if("number"==typeof t){if(t<1){alert("chinese"===window.GLOBAL.languageName?"跳转的页数不能小于1":"The page number of the jump cannot be less than 1.");var n=window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.clock().timestamp().slideIndex()+1;return void(this.value=n)}if(t>window.GLOBAL.ServiceNewPptAynamicPPT.slidesCount){alert("chinese"===window.GLOBAL.languageName?"跳转的页数不能大于"+window.GLOBAL.ServiceNewPptAynamicPPT.slidesCount:"The page number of the jump cannot be greater than "+window.GLOBAL.ServiceNewPptAynamicPPT.slidesCount);n=window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.clock().timestamp().slideIndex()+1;return void(this.value=n)}window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo();window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoTimestamp(t-1,0,0,!0,{initiative:!0})}},r.appendChild(c);var s=document.createElement("span");s.id="customController_totalSlideSpan",s.className="total-slide-span",s.innerHTML="&nbsp;/&nbsp;&nbsp;0",r.appendChild(s);var p=document.createElement("button");p.id="customController_nextStep",p.className="next-step",p.innerHTML="chinese"===window.GLOBAL.languageName?"下一帧":"Next Step",p.onclick=function(e){window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextStep({initiative:!0})},r.appendChild(p);var P=document.createElement("button");P.id="customController_nextSlide",P.className="next-slide",P.innerHTML="chinese"===window.GLOBAL.languageName?"下一页":"Next Page",P.onclick=function(e){window.GLOBAL.ServiceNewPptAynamicPPT.clearOldSlideInfo(),window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.gotoNextSlide(!0,{initiative:!0})},r.appendChild(P),document.body.appendChild(r),window.GLOBAL.checkCustomControllerButtonState=function(){if(window.GLOBAL.ServiceNewPptAynamicPPT&&window.GLOBAL.ServiceNewPptAynamicPPT.playbackController){r.style.display="",s.innerHTML="&nbsp;/&nbsp;&nbsp;"+window.GLOBAL.ServiceNewPptAynamicPPT.slidesCount;var e=window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.clock().timestamp(),t=e.slideIndex()+1,n=0<=e.stepIndex()?e.stepIndex():0,i=null;if(window.GLOBAL.ServiceNewPptAynamicPPT.playbackController&&window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.currentSlide)try{var a=window.GLOBAL.ServiceNewPptAynamicPPT.playbackController.currentSlide();if(a&&a.animationSteps){var o=a.animationSteps();a&&a.animationSteps&&(i=o.count())}}catch(e){dynamicPptLog.error("that.playbackController.currentSlide error:",e)}t<=1?l.setAttribute("disabled",!0):l.removeAttribute("disabled"),t>=window.GLOBAL.ServiceNewPptAynamicPPT.slidesCount?P.setAttribute("disabled",!0):P.removeAttribute("disabled"),t<=1&&n<=0?d.setAttribute("disabled",!0):d.removeAttribute("disabled"),t>=window.GLOBAL.ServiceNewPptAynamicPPT.slidesCount&&i-1<=n?p.setAttribute("disabled",!0):p.removeAttribute("disabled"),c.value=t}}}};try{startPlaying()}catch(e){dynamicPptLog.error("动态PPT出现错误，错误信息:",e)}};